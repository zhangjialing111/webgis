<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <title>å¯¼èˆªè·¯çº¿è§„åˆ’</title>
    <style type="text/css">
        body,
        html {
            width: 100%;
            height: 100%;
            margin: 0;
            font-family: "å¾®è½¯é›…é»‘";
        }

        a {
            text-decoration: none;
            color: black;
        }

        #l-map,
        .l-search {
            float: left;
            height: 100%;
        }

        #l-map {
            width: 75%;
        }

        .l-search {
            width: 25%;
        }

        .ls-top {
            width: 100%;
            height: 10%;
        }

        .ls-down {
            width: 100%;
            height: 90%;
        }

        .lst-t,
        .lst-d {
            width: 100%;
            height: 50%;
        }

        .lst-t>div {
            height: 100%;
            width: 80%;
            margin: 0 auto;
        }

        .lst-d>a {
            display: inline-block;
            width: 48%;
            text-align: center;
            font-weight: 900;
            border: 2px solid black;
        }

        #r-result,
        #r-result table {
            height: 100%;
            width: 100%;
            overflow: scroll;
        }

        #r-result2,
        #r-result2 table {
            height: 100%;
            width: 100%;
            overflow: scroll;
        }

        #r-result2 {
            display: none;
        }

        .transformation{
    cursor: pointer;
        }
/* è½¬æ¢æŒ‰é’® */
    </style>

    <script type="text/javascript" src="https://api.map.baidu.com/api?v=2.0&ak=nSxiPohfziUaCuONe4ViUP2N"></script>
    <title>é©¾è½¦å¯¼èˆªçš„ç»“æœé¢æ¿</title>
</head>

<body>
    <div class="l-search">
        <div class="ls-top">
            <div class="lst-t">
                <div>
                    <span id="s-or-e" class="start">èµ·ç‚¹ï¼š</span>
                    <input type="text" id="keyword">
                    <button>æœç´¢</button>
                    <span class="transformation">è½¬æ¢</span>
                </div>
            </div>
            <div class="lst-d">
                <a href="#" id="transit">å…¬å…±äº¤é€šè·¯çº¿</a>
                <a href="#" id="driving">è‡ªä¸»é©¾è½¦è·¯çº¿</a>
            </div>
        </div>
        <div class="ls-down">
            <div id="r-result"></div>
            <div id="r-result2"></div>
        </div>
    </div>
    <div id="l-map"></div>
</body>

</html>
<script type="text/javascript">
    // ç™¾åº¦åœ°å›¾APIåŠŸèƒ½
    var map = new BMap.Map("l-map");

    var position = [103.730911, 36.111363];
    map.centerAndZoom(new BMap.Point(position[0], position[1]), 14); // è®¾ç½®åœ°å›¾ä¸­å¿ƒä¸ºæ­¢ï¼Œä»¥åŠç¼©æ”¾ç¨‹åº¦
    map.enableScrollWheelZoom(true); //å¼€å¯é¼ æ ‡æ»šè½®ç¼©æ”¾

    map.addControl(new BMap.ScaleControl());//æ·»åŠ æ¯”ä¾‹å°º
    map.addControl(new BMap.NavigationControl());//æ·»åŠ å¹³ç§»ç¼©æ”¾æ§ä»¶
    map.addControl(new BMap.OverviewMapControl());//æ·»åŠ ç¼©ç•¥åœ°å›¾
    map.addControl(new BMap.MapTypeControl());//æ·»åŠ åœ°å›¾ç±»å‹
    map.addControl(new BMap.CityListControl());//æ·»åŠ åŸå¸‚åˆ—è¡¨
     

    var driving = new BMap.DrivingRoute(map, {
        renderOptions: {
            map: map,
            panel: "r-result",
            autoViewport: false,
            selectFirstResult: true,
            highlightMode: BMAP_HIGHLIGHT_ROUTE
        }
    }); // è‡ªä¸»é©¾è½¦è·¯çº¿

    var transit = new BMap.TransitRoute(map, {
        renderOptions: {
            map: map,
            panel: "r-result2"
        }
    }); // å…¬å…±äº¤é€šè·¯çº¿

    var button = document.querySelector('button');
    var keyword = document.querySelector('#keyword');
    var transit1 = document.querySelector('#transit');
    var driving1 = document.querySelector('#driving');
    var a_s = document.querySelectorAll('.lst-d >a');
    var result1 = document.querySelector('#r-result');
    var result2 = document.querySelector('#r-result2');

    var s_or_e = document.querySelector("#s-or-e");
// èµ·ç‚¹æˆ–è€…ç»ˆç‚¹
var re_color = function() {
    a_s.forEach(function(ele, index) {
        ele.style.color = 'black';
    });
}

var start_destination = 'å…°å·äº¤é€šå¤§å­¦';

button.onclick = function() {
    let v = keyword.value;
    let class_name = s_or_e.className;
    if (v != '') {
        transit.clearResults();
        driving.clearResults();
        if (class_name == 'start') {
            transit.search(v, start_destination);
        } else {
            transit.search(start_destination, v);
        }
        re_color();
        transit1.style.color = 'red';
        result1.style.display = 'none';
        result2.style.display = 'block';
        map.setZoom(14);
        map.setCenter(start_destination);
    } else {
        alert(`è¯·è¾“å…¥{class_name=='start'?'èµ·ç‚¹':'ç»ˆç‚¹'}ï¼ğŸ˜Š`);
    }
}

transit1.onclick = function() {
    let v = keyword.value;
    let class_name = s_or_e.className;
    if (v != '') {
        driving.clearResults();
        transit.clearResults();
        re_color();
        if (class_name == 'start') {
            transit.search(v, start_destination);
        } else {
            transit.search(start_destination, v);
        }
        transit1.style.color = 'red';
        result1.style.display = 'none';
        result2.style.display = 'block';
        map.setZoom(14);
        map.setCenter(start_destination);
    } else {
        alert(`è¯·è¾“å…¥{class_name=='start'?'èµ·ç‚¹':'ç»ˆç‚¹'}ï¼ğŸ˜Š`);
    }
}

driving1.onclick = function() {
    let v = keyword.value;
    let class_name = s_or_e.className;
    if (v != '') {
        driving.clearResults();
        transit.clearResults();
        if (class_name == 'start') {
            driving.search(v, start_destination);
        } else {
            driving.search(start_destination, v);
        }
        re_color();
        driving1.style.color = 'red';
        result1.style.display = 'block';
        result2.style.display = 'none';
        map.setZoom(8);
    } else {
        alert(`è¯·è¾“å…¥{class_name=='start'?'èµ·ç‚¹':'ç»ˆç‚¹'}ï¼ğŸ˜Š`);
    }
}

var trans_btn = document.querySelector(".transformation");
// è½¬æ¢æŒ‰é’®
trans_btn.onclick = function() {
    if (s_or_e.className == 'start') {
        s_or_e.innerText = 'ç»ˆç‚¹ï¼š'
        s_or_e.className = 'end';
    } else if (s_or_e.className == 'end') {
        s_or_e.innerText = 'èµ·ç‚¹ï¼š';
        s_or_e.className = 'start';
    }
}
</script>
